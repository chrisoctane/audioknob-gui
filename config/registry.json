{
  "knobs": [
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "permissions",
      "description": "Adds current user to audio-related groups (audio, realtime, pipewire). Required for RT limits and low-latency audio. Reboot required to take effect.",
      "id": "audio_group_membership",
      "impl": {
        "kind": "group_membership",
        "params": {
          "groups": [
            "audio",
            "realtime",
            "pipewire"
          ]
        }
      },
      "requires_commands": [],
      "requires_groups": [],
      "requires_reboot": true,
      "requires_root": true,
      "risk_level": "low",
      "title": "Audio Groups"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "permissions",
      "description": "Allows audio apps in the 'audio' group to request realtime priority (rtprio 95), lock memory (memlock unlimited), and use nice -10. Essential for low-latency audio. Log out/in or reboot required to take effect.",
      "id": "rt_limits_audio_group",
      "impl": {
        "kind": "pam_limits_audio_group",
        "params": {
          "lines": [
            "@audio   -  rtprio     95",
            "@audio   -  memlock    unlimited",
            "@audio   -  nice      -10"
          ],
          "path": "/etc/security/limits.d/99-audioknob-gui.conf"
        }
      },
      "requires_commands": [],
      "requires_groups": [
        "audio",
        "realtime"
      ],
      "requires_reboot": true,
      "requires_root": true,
      "risk_level": "low",
      "title": "RT Limits"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "irq",
      "description": "Stops irqbalance service so audio IRQs don't get moved between CPUs unexpectedly. Reduces latency jitter.",
      "id": "irqbalance_disable",
      "impl": {
        "kind": "systemd_unit_toggle",
        "params": {
          "action": "disable_now",
          "unit": "irqbalance.service"
        }
      },
      "requires_commands": [],
      "requires_groups": [],
      "requires_reboot": false,
      "requires_root": true,
      "risk_level": "medium",
      "title": "IRQ Balance"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "irq",
      "description": "Enables rtirq service which sets high realtime priorities for audio-related IRQ threads. Requires rtirq package. File: /etc/sysconfig/rtirq or /etc/rtirq.conf.",
      "id": "rtirq_enable",
      "impl": {
        "kind": "systemd_unit_toggle",
        "params": {
          "action": "enable_now",
          "unit": "rtirq.service"
        }
      },
      "requires_commands": [
        "rtirq"
      ],
      "requires_groups": [],
      "requires_reboot": false,
      "requires_root": true,
      "risk_level": "medium",
      "title": "RT IRQ"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "cpu",
      "description": "Sets CPU frequency governor to 'performance' (until reboot). Prevents CPU frequency scaling which can cause latency spikes. File: /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor",
      "id": "cpu_governor_performance_temp",
      "impl": {
        "kind": "sysfs_glob_kv",
        "params": {
          "glob": "/sys/devices/system/cpu/cpu*/cpufreq/scaling_governor",
          "value": "performance"
        }
      },
      "requires_commands": [],
      "requires_groups": [],
      "requires_reboot": false,
      "requires_root": true,
      "risk_level": "low",
      "title": "CPU Performance (until reboot)"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "cpu",
      "description": "Sets CPU governor to 'performance' now AND configures it to persist across reboots (best-effort). On openSUSE/Fedora this writes /etc/sysconfig/cpupower and enables cpupower.service. Reset restores original config via transaction backups.",
      "id": "cpu_governor_performance_persistent",
      "impl": {
        "kind": "sysfs_glob_kv",
        "params": {
          "glob": "/sys/devices/system/cpu/cpu*/cpufreq/scaling_governor",
          "value": "performance"
        }
      },
      "requires_commands": [
        "cpupower"
      ],
      "requires_groups": [],
      "requires_reboot": false,
      "requires_root": true,
      "risk_level": "medium",
      "title": "CPU Performance (persistent)"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "cpu",
      "description": "Creates udev rule to allow audio group write access to /dev/cpu_dma_latency. Enables apps to request low C-state latency. File: /etc/udev/rules.d/99-cpu-dma-latency.rules",
      "id": "cpu_dma_latency_udev",
      "impl": {
        "kind": "udev_rule",
        "params": {
          "content": "KERNEL==\"cpu_dma_latency\", GROUP=\"audio\", MODE=\"0660\"",
          "path": "/etc/udev/rules.d/99-cpu-dma-latency.rules"
        }
      },
      "requires_commands": [],
      "requires_groups": [
        "audio",
        "realtime"
      ],
      "requires_reboot": false,
      "requires_root": true,
      "risk_level": "low",
      "title": "DMA Latency"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "vm",
      "description": "Sets vm.swappiness=10 to reduce swapping, avoiding latency spikes under memory pressure. File: /etc/sysctl.d/99-audioknob-gui.conf",
      "id": "swappiness",
      "impl": {
        "kind": "sysctl_conf",
        "params": {
          "lines": [
            "vm.swappiness=10"
          ],
          "path": "/etc/sysctl.d/99-audioknob-gui.conf"
        }
      },
      "requires_commands": [],
      "requires_groups": [],
      "requires_reboot": false,
      "requires_root": true,
      "risk_level": "low",
      "title": "Swappiness"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "vm",
      "description": "Sets Transparent Huge Pages to 'madvise' mode. Recommended for latency-sensitive audio workloads. File: /sys/kernel/mm/transparent_hugepage/enabled",
      "id": "thp_mode_madvise",
      "impl": {
        "kind": "sysfs_glob_kv",
        "params": {
          "glob": "/sys/kernel/mm/transparent_hugepage/enabled",
          "value": "madvise"
        }
      },
      "requires_commands": [],
      "requires_groups": [],
      "requires_reboot": false,
      "requires_root": true,
      "risk_level": "medium",
      "title": "Huge Pages"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "vm",
      "description": "Sets fs.inotify.max_user_watches=600000 for DAWs that watch many files. Prevents 'too many open files' errors. File: /etc/sysctl.d/99-audioknob-inotify.conf",
      "id": "inotify_max_watches",
      "impl": {
        "kind": "sysctl_conf",
        "params": {
          "lines": [
            "fs.inotify.max_user_watches=600000"
          ],
          "path": "/etc/sysctl.d/99-audioknob-inotify.conf"
        }
      },
      "requires_commands": [],
      "requires_groups": [],
      "requires_reboot": false,
      "requires_root": true,
      "risk_level": "low",
      "title": "Inotify Watches"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "vm",
      "description": "Lowers vm.dirty_bytes to 50MB and vm.dirty_background_bytes to 16MB to reduce I/O latency from writeback. File: /etc/sysctl.d/99-audioknob-dirty.conf",
      "id": "dirty_bytes",
      "impl": {
        "kind": "sysctl_conf",
        "params": {
          "lines": [
            "vm.dirty_bytes=52428800",
            "vm.dirty_background_bytes=16777216"
          ],
          "path": "/etc/sysctl.d/99-audioknob-dirty.conf"
        }
      },
      "requires_commands": [],
      "requires_groups": [],
      "requires_reboot": false,
      "requires_root": true,
      "risk_level": "low",
      "title": "Dirty Bytes"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "power",
      "description": "Disables USB autosuspend to prevent USB audio device dropouts. Creates udev rule. File: /etc/udev/rules.d/99-usb-no-autosuspend.rules",
      "id": "usb_autosuspend_disable",
      "impl": {
        "kind": "udev_rule",
        "params": {
          "content": "ACTION==\"add\", SUBSYSTEM==\"usb\", ATTR{power/autosuspend}=\"-1\"",
          "path": "/etc/udev/rules.d/99-usb-no-autosuspend.rules"
        }
      },
      "requires_commands": [],
      "requires_groups": [],
      "requires_reboot": false,
      "requires_root": true,
      "risk_level": "low",
      "title": "USB Power"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "kernel",
      "description": "Adds 'threadirqs' to kernel cmdline. Makes IRQ handlers schedulable for better RT performance. Requires reboot. File: /etc/kernel/cmdline (openSUSE TW) or /etc/default/grub",
      "id": "kernel_threadirqs",
      "impl": {
        "kind": "kernel_cmdline",
        "params": {
          "param": "threadirqs"
        }
      },
      "requires_commands": [],
      "requires_groups": [],
      "requires_reboot": true,
      "requires_root": true,
      "risk_level": "medium",
      "title": "Threaded IRQs"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "kernel",
      "description": "Adds 'audit=0' to kernel cmdline. Reduces overhead from audit subsystem. Requires reboot. File: /etc/kernel/cmdline or /etc/default/grub",
      "id": "kernel_audit_off",
      "impl": {
        "kind": "kernel_cmdline",
        "params": {
          "param": "audit=0"
        }
      },
      "requires_commands": [],
      "requires_groups": [],
      "requires_reboot": true,
      "requires_root": true,
      "risk_level": "medium",
      "title": "Kernel Audit"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "kernel",
      "description": "Adds 'mitigations=off' to kernel cmdline. SECURITY TRADEOFF: Improves performance but disables Spectre/Meltdown protections. Requires reboot.",
      "id": "kernel_mitigations_off",
      "impl": {
        "kind": "kernel_cmdline",
        "params": {
          "param": "mitigations=off"
        }
      },
      "requires_commands": [],
      "requires_groups": [],
      "requires_reboot": true,
      "requires_root": true,
      "risk_level": "high",
      "title": "CPU Mitigations"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "stack",
      "description": "Ensures QjackCtl Server command includes taskset pinning (default cores 0,1), -R, and -P90. Optional: change cores via Config. File: ~/.config/rncbc.org/QjackCtl.conf",
      "id": "qjackctl_server_prefix_rt",
      "impl": {
        "kind": "qjackctl_server_prefix",
        "params": {
          "cpu_cores": "0,1",
          "ensure_priority": true,
          "ensure_rt": true,
          "path": "~/.config/rncbc.org/QjackCtl.conf"
        }
      },
      "requires_commands": [
        "qjackctl"
      ],
      "requires_groups": [
        "audio",
        "realtime"
      ],
      "requires_reboot": false,
      "requires_root": false,
      "risk_level": "low",
      "title": "QjackCtl RT"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "stack",
      "description": "Configures PipeWire buffer size (quantum). Lower = less latency, more CPU. System default is 1024; we recommend 128-256 for pro audio. PipeWire will be restarted automatically after applying. File: ~/.config/pipewire/pipewire.conf.d/99-audioknob-quantum.conf",
      "id": "pipewire_quantum",
      "impl": {
        "kind": "pipewire_conf",
        "params": {
          "path": "~/.config/pipewire/pipewire.conf.d/99-audioknob-quantum.conf",
          "quantum": 256
        }
      },
      "requires_commands": [],
      "requires_groups": [],
      "requires_reboot": false,
      "requires_root": false,
      "risk_level": "low",
      "title": "PW Buffer"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "stack",
      "description": "Configures PipeWire default sample rate. System default is 48000 Hz. Higher rates (96k/192k) for hi-res audio. PipeWire will be restarted automatically after applying. File: ~/.config/pipewire/pipewire.conf.d/99-audioknob-rate.conf",
      "id": "pipewire_sample_rate",
      "impl": {
        "kind": "pipewire_conf",
        "params": {
          "path": "~/.config/pipewire/pipewire.conf.d/99-audioknob-rate.conf",
          "rate": 48000
        }
      },
      "requires_commands": [],
      "requires_groups": [],
      "requires_reboot": false,
      "requires_root": false,
      "risk_level": "low",
      "title": "PW Sample Rate"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "services",
      "description": "Masks tracker-miner-fs and tracker-extract services (file indexer) which cause latency spikes during indexing. GNOME desktops only.",
      "id": "disable_tracker",
      "impl": {
        "kind": "user_service_mask",
        "params": {
          "services": [
            "tracker-miner-fs-3.service",
            "tracker-miner-fs.service",
            "tracker-extract-3.service",
            "tracker-extract.service"
          ]
        }
      },
      "requires_commands": [],
      "requires_groups": [],
      "requires_reboot": false,
      "requires_root": false,
      "risk_level": "low",
      "title": "GNOME Indexer"
    },
    {
      "capabilities": {
        "apply": true,
        "read": true,
        "restore": true
      },
      "category": "services",
      "description": "Disables Baloo file indexer (KDE) which causes latency spikes during indexing. Uses balooctl to disable. KDE desktops only.",
      "id": "disable_baloo",
      "impl": {
        "kind": "baloo_disable",
        "params": {}
      },
      "requires_commands": [
        "balooctl"
      ],
      "requires_groups": [],
      "requires_reboot": false,
      "requires_root": false,
      "risk_level": "low",
      "title": "KDE Indexer"
    },
    {
      "capabilities": {
        "apply": false,
        "read": true,
        "restore": false
      },
      "category": "testing",
      "description": "Shows what audio server is active: PipeWire, JACK, or ALSA only. Also lists ALSA playback devices.",
      "id": "stack_detect",
      "impl": {
        "kind": "read_only",
        "params": {
          "what": "stack_detect"
        }
      },
      "requires_commands": [],
      "requires_groups": [],
      "requires_reboot": false,
      "requires_root": false,
      "risk_level": "low",
      "title": "Audio Stack"
    },
    {
      "capabilities": {
        "apply": false,
        "read": true,
        "restore": false
      },
      "category": "testing",
      "description": "Runs cyclictest to measure scheduler latency jitter. Shows max latency in microseconds. Lower is better. Requires cyclictest (rt-tests package).",
      "id": "scheduler_jitter_test",
      "impl": {
        "kind": "read_only",
        "params": {
          "what": "cyclictest"
        }
      },
      "requires_commands": [
        "cyclictest"
      ],
      "requires_groups": [],
      "requires_reboot": false,
      "requires_root": true,
      "risk_level": "low",
      "title": "Jitter Test"
    },
    {
      "capabilities": {
        "apply": false,
        "read": true,
        "restore": false
      },
      "category": "testing",
      "description": "Comprehensive realtime readiness scan. Checks: audio group, CPU governor, swappiness, inotify, kernel RT/threadirqs, high-res timers, irqbalance, THP, USB autosuspend, HPET/RTC access, filesystems, and more. Based on realtimeconfigquickscan but improved.",
      "id": "blocker_check",
      "impl": {
        "kind": "read_only",
        "params": {
          "what": "rtcheck"
        }
      },
      "requires_commands": [],
      "requires_groups": [],
      "requires_reboot": false,
      "requires_root": false,
      "risk_level": "low",
      "title": "RT Scan"
    }
  ],
  "schema": 1
}
