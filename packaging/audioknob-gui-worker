#!/usr/bin/env python3
"""Root worker launcher.

Intended install location:
  /usr/local/libexec/audioknob-gui-worker

This must be runnable by root via pkexec.
For development, we add the repo path to sys.path.
For production, install the package system-wide.
"""

from __future__ import annotations

import sys
from pathlib import Path

# For development: add repo root to path so we can import audioknob_gui
# The repo is at /home/chris/audioknob-gui (adjust if installed elsewhere)
_DEV_REPO_PATH = "/home/chris/audioknob-gui"
if Path(_DEV_REPO_PATH).exists():
    sys.path.insert(0, _DEV_REPO_PATH)


def main() -> int:
    try:
        from audioknob_gui.worker.cli import main as worker_main
    except Exception as e:
        print(
            "audioknob-gui worker is not installed system-wide.\n"
            "Install this project into system python (or package it) so root can import it.\n\n"
            f"Import error: {e}",
            file=sys.stderr,
        )
        return 2

    return int(worker_main())


if __name__ == "__main__":
    raise SystemExit(main())
